{% extends "layout.html" %}

{% block title %}{% endblock %}

{% block content %}
<h1>{{problem.title}}</h1>
<div>{{problem.cond}}</div>
<textarea id="codeArea">{{problem.view}}</textarea>
<div><button id="checkButton">Check</button></div>
<input type="hidden" id="problemId" value="{{problem.id}}">
<div id="message"></div>

<script>
   const codeArea = document.getElementById("codeArea");
   const checkButton = document.getElementById("checkButton");
   const problemId = document.getElementById("problemId");
   const message = document.getElementById("message");

   checkButton.addEventListener("click", async () => {
      const payload = {
         id: problemId.value,
         solving: codeArea.value
      };

      try {
         const response = await fetch("/check", {
            method: "POST",
            headers: {
               "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
         });

         if (!response.ok) {
            throw new Error("HTTP error " + response.status);
         }

         const data = await response.json(); // або response.text(), залежно від вашого API
         console.log("Server response:", data);
         message.innerHTML = data;

      } catch (err) {
         console.error("Request failed:", err);
      }
   });
</script>

{% endblock %}